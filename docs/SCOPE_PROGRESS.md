# プロジェクト進捗管理

## Phase進捗

- [x] **Phase 1: 要件定義** - 完了
- [ ] Phase 2: Git/GitHub管理
- [ ] Phase 3: フロントエンド基盤構築
- [ ] Phase 4: ページ実装
- [ ] Phase 5: バックエンド実装（Rust/Tauri）
- [ ] Phase 6: テスト・品質保証
- [ ] Phase 7: 配布・デプロイ
- [ ] Phase 8: ドキュメント作成
- [ ] Phase 9: 本番環境設定
- [ ] Phase 10: リリース準備
- [ ] Phase 11: 機能拡張（必要時）

---

## 統合ページ管理表

| ID | ページ名 | ルート | 権限レベル | 統合機能 | 着手 | 完了 |
|----|---------|-------|----------|---------|------------|-------------------|
| P-001 | メインページ（バックアップ実行） | `/` | ユーザー | フォルダ選択・実行・進捗監視 | [ ] | [ ] |
| P-002 | 設定ページ | `/settings` | ユーザー | SSH設定・接続テスト・保存先設定 | [ ] | [ ] |

---

## 技術仕様サマリー

**アーキテクチャ**: Tauri 2.x（Rust + React）
**開発期間**: 2週間（MVP）
**配布方法**: GitHub Releases（無料）
**対応OS**: macOS 10.15+, Windows 7+

---

## 要件定義完了事項

- ✅ 成果目標の明確化
- ✅ 技術実現可能性の検証
- ✅ MVPアプローチの選択
- ✅ 2ページ構成の確定
- ✅ Tauri技術スタックの決定
- ✅ セキュリティ要件の策定
- ✅ 外部サービス要件の確定
- ✅ 品質基準・Lint設定の完了

---

## 1. 基本情報

- **ステータス**: 要件定義完了
- **完了タスク数**: Phase 1完了
- **進捗率**: Phase 1/11完了
- **次のマイルストーン**: Git/GitHub管理またはTauri環境構築
- **最終更新日**: 2026-01-08

### ✅ 追加完了: クロスプラットフォーム技術調査
- 開発フレームワーク比較 (Tauri, Electron, Python, Go, ブラウザ)
- SFTP転送ライブラリ性能評価 (2026年最新ベンチマーク)
- 認証情報管理方法調査 (OS標準キーチェーン統合)
- 配布・自動更新機能調査

**最終決定**: **Tauri 2.x を採用**
- バイナリサイズ: 5MB以下 (Electronの1/20)
- メモリ使用: 40MB以下 (Electronの1/6)
- 起動速度: 0.4秒 (Electronの1/4)
- セキュリティ: Rust + OS標準キーチェーン統合
- 配布: GitHub Releases + 署名付き自動更新

詳細は `/Users/lennon/projects/バックアップ自動ツール/docs/requirements.md` を参照

## 2. 技術調査結果（2026-01-08）

### エックスサーバーSSH/SFTP接続仕様

#### 接続仕様
- **SSH対応**: 公開鍵認証のみサポート（パスワード認証非対応）
- **接続ポート**: 10022（標準の22番ポートではない）
- **SFTP対応**: SSH上で動作するSFTPプロトコル完全サポート
- **rsync対応**: SSH経由でrsyncコマンド利用可能

#### 認証設定
- サーバーパネルでSSH設定を「ON」に変更
- 公開鍵認証用の鍵ペアを生成（パスフレーズ設定）
- 秘密鍵をダウンロード（OpenSSH形式）
- 接続時の認証情報:
  - ホスト: FTPホスト名（サーバーアカウント設定メールに記載）
  - ユーザー名: FTPユーザー名（サーバーアカウント設定メールに記載）
  - ポート: 10022
  - 認証: 秘密鍵ファイル

#### FTP/FTPS対応
- FTP: 利用可能（非推奨 - 暗号化なし）
- FTPS（Explicit）: 利用可能
- PASV（パッシブ）モード推奨
- アップロード先: ../ドメイン名/public_html/

#### ファイル転送制限
- 転送量: 無制限（課金なし）※過大な負荷時は制限の可能性あり
- ファイルアップロードサイズ: デフォルト1GB、最大2GBまで設定可能
- php.ini設定でupload_max_filesize、post_max_size、memory_limit調整可能

### クライアントツール選定

#### Windows環境
1. **WinSCP**（推奨）
   - 無料、SFTP/SCP/FTP/FTPS/S3/WebDAV対応
   - スクリプトインターフェース、.NETアセンブリでの自動化対応
   - バッチファイル、タスクスケジューラーとの連携可能
   - 注意: OpenSSH形式の鍵をPuTTY形式に変換が必要

2. **MobaXterm**
   - リモート管理機能統合
   - プログラマー、管理者向けツールボックス

3. **FileZilla**
   - 無料、オープンソース
   - クロスプラットフォーム（Windows/macOS/Linux）

#### macOS環境
1. **Transmit 5**（商用）
   - バッチファイル管理、ドラッグ&ドロップ
   - ターミナル統合
   - 2FA、OTP、PKCS 11対応
   - ChaCha Poly1305暗号化

2. **標準SSH/SFTPコマンド**
   - macOS標準搭載
   - コマンドライン自動化に最適
   - rsyncとの組み合わせ可能

3. **Cyberduck**
   - 無料、オープンソース
   - SFTP/FTPS/WebDAV対応

#### クロスプラットフォーム
1. **FileZilla**
2. **Cyberduck**

### 自動化の技術的制約と解決策

#### 認証の自動化
- **課題**: 公開鍵認証のパスフレーズ入力
- **解決策**:
  1. パスフレーズなしの鍵ペア生成（セキュリティリスク有）
  2. ssh-agentを使用した鍵の事前ロード
  3. 環境変数やセキュアストレージへの鍵パス保存

#### バッチ処理実装
- **Windows**: タスクスケジューラー + WinSCPスクリプト
  - 手順: 公開鍵認証設定 → バッチファイル作成 → アカウント権限設定 → タスクスケジューラー登録
- **macOS**: cron/launchd + ssh/sftpコマンド
  - ssh-agentまたは鍵ファイル直接指定

#### セキュリティベストプラクティス（2026年）
1. **認証方式**
   - SSH鍵認証を優先（パスワード認証より安全）
   - 鍵長: RSA 2048bit以上、ECDSA/Ed25519 256bit以上推奨
   - 鍵の定期ローテーション

2. **多要素認証（MFA）**
   - 2FA実装を推奨（エックスサーバーでの対応状況要確認）

3. **パスワードポリシー**
   - 最低8文字、複雑性要件
   - 10回連続失敗でIP制限
   - パスワード再利用禁止

4. **アクセス制御**
   - IP制限設定（エックスサーバーのFTP制限設定機能）
   - ファイアウォール設定
   - 侵入検知システム
   - 異常アクティビティ監視

5. **鍵管理**
   - 秘密鍵ファイルのパーミッション: 600または400
   - HSM（Hardware Security Module）での保存推奨
   - 自動化スクリプトでのエラーハンドリング、ログ記録必須

#### 大容量ファイル転送
- 転送量無制限を活用
- rsync差分転送で効率化
  - コマンド例: `rsync -avz --bwlimit=10240 -e 'ssh -p 10022 -i ~/.ssh/private_key.key' user@server:/source/ /dest/`
- 帯域制限オプション（--bwlimit）で過負荷回避

### 代替手段の評価

#### FTP/FTPS
- **利用可能性**: ○（エックスサーバー対応）
- **セキュリティ**: △（FTPは暗号化なし、FTPSは可）
- **推奨度**: 低（SFTPを優先すべき）

#### WebDAV
- **利用可能性**: 調査不能（検索エラー）
- **推奨度**: 要確認（標準的にはエックスサーバーで非対応の可能性高）

#### rsync over SSH
- **利用可能性**: ○（完全対応）
- **セキュリティ**: ◎（SSH暗号化）
- **推奨度**: 高（差分転送で効率的）
- **注意点**: ポート10022指定、公開鍵認証必須

### 推奨技術スタック

#### 最優先案: SFTP + rsync（SSH経由）
- **メリット**: セキュア、効率的、標準的
- **デメリット**: 初期設定（公開鍵登録）が必要
- **自動化**: 容易（全OS対応）

#### Windows実装
- ツール: WinSCP（スクリプトモード）
- スケジュール: Windowsタスクスケジューラー
- 認証: OpenSSH秘密鍵（PuTTY形式に変換）

#### macOS実装
- ツール: 標準ssh/sftp + rsync
- スケジュール: launchd
- 認証: OpenSSH秘密鍵（そのまま利用可）

#### クロスプラットフォーム実装
- ツール: FileZilla（CLI版）またはCyberduck（CLI版）
- 言語: Python（paramiko、pysftp）またはNode.js（ssh2-sftp-client）
- スケジュール: 各OS標準機能

### 技術的結論

エックスサーバーでのSSH/SFTP接続は完全に実現可能。公開鍵認証の初期設定が必須だが、一度設定すれば全OSで安定した自動バックアップが実現できる。rsyncとの組み合わせにより差分転送も可能で、大容量ファイルにも対応可能。

**次のステップ**: 要件定義でユーザーの環境（OS）と希望する自動化レベルを確認し、具体的な実装方式を決定。

## 3. 実装計画

BlueLampでの開発は以下のフローに沿って進行します。

### 開始手順

開発プロンプトをクリックして「Phase @1: 要件定義」を選択し、要件定義エンジニアを活用するところから始めてください。
